(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"0dNq":function(e,t,n){"use strict";n.r(t);var i=n("ofXK"),o=n("tyNb"),l=n("wd/R"),a=n("fXoL"),r=n("H+bZ"),d=n("2Rin"),s=n("dbUT"),c=n("3Pt+"),m=n("xJkR");const g=["basicModal"],p=["scrollMe"];function u(e,t){if(1&e&&(a["\u0275\u0275elementStart"](0,"div",28),a["\u0275\u0275elementStart"](1,"div",29),a["\u0275\u0275elementStart"](2,"span",30),a["\u0275\u0275text"](3),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"]()),2&e){const e=a["\u0275\u0275nextContext"]();a["\u0275\u0275advance"](3),a["\u0275\u0275textInterpolate"](e.util.translate("Loading..."))}}function h(e,t){if(1&e&&(a["\u0275\u0275elementStart"](0,"div",33),a["\u0275\u0275elementStart"](1,"div",34),a["\u0275\u0275elementStart"](2,"div",35),a["\u0275\u0275elementStart"](3,"p"),a["\u0275\u0275text"](4),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"]()),2&e){const e=a["\u0275\u0275nextContext"]().$implicit;a["\u0275\u0275advance"](4),a["\u0275\u0275textInterpolate"](e.message)}}function f(e,t){if(1&e&&(a["\u0275\u0275elementStart"](0,"div",36),a["\u0275\u0275elementStart"](1,"div",34),a["\u0275\u0275elementStart"](2,"div",35),a["\u0275\u0275elementStart"](3,"p"),a["\u0275\u0275text"](4),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"]()),2&e){const e=a["\u0275\u0275nextContext"]().$implicit;a["\u0275\u0275advance"](4),a["\u0275\u0275textInterpolate"](e.message)}}function v(e,t){if(1&e&&(a["\u0275\u0275elementStart"](0,"span"),a["\u0275\u0275template"](1,h,5,1,"div",31),a["\u0275\u0275template"](2,f,5,1,"div",32),a["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=a["\u0275\u0275nextContext"]();a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("ngIf",e.from_id!=n.uid),a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("ngIf",e.from_id==n.uid)}}function x(e,t){if(1&e&&(a["\u0275\u0275elementStart"](0,"div",37),a["\u0275\u0275elementStart"](1,"div",29),a["\u0275\u0275elementStart"](2,"span",30),a["\u0275\u0275text"](3),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"]()),2&e){const e=a["\u0275\u0275nextContext"]();a["\u0275\u0275advance"](3),a["\u0275\u0275textInterpolate"](e.util.translate("Loading..."))}}const y=function(e){return{"background-image":e}};function _(e,t){if(1&e){const e=a["\u0275\u0275getCurrentView"]();a["\u0275\u0275elementStart"](0,"div",23),a["\u0275\u0275listener"]("click",(function(){a["\u0275\u0275restoreView"](e);const n=t.$implicit;return a["\u0275\u0275nextContext"]().onChat(n)})),a["\u0275\u0275elementStart"](1,"div",24),a["\u0275\u0275element"](2,"div",25),a["\u0275\u0275elementStart"](3,"p",26),a["\u0275\u0275text"](4),a["\u0275\u0275element"](5,"br"),a["\u0275\u0275elementStart"](6,"span",38),a["\u0275\u0275text"](7),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=a["\u0275\u0275nextContext"]();a["\u0275\u0275advance"](2),a["\u0275\u0275property"]("ngStyle",a["\u0275\u0275pureFunction1"](3,y,"url("+n.api.mediaURL+e.cover+")")),a["\u0275\u0275advance"](2),a["\u0275\u0275textInterpolate1"](" ",e.name," "),a["\u0275\u0275advance"](3),a["\u0275\u0275textInterpolate"](e.mobile)}}const M=function(){return{"border-radius":"5px",height:"120px",width:"100%"}};function b(e,t){1&e&&(a["\u0275\u0275elementStart"](0,"div",41),a["\u0275\u0275element"](1,"ngx-skeleton-loader",42),a["\u0275\u0275elementEnd"]()),2&e&&(a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("theme",a["\u0275\u0275pureFunction0"](1,M)))}const S=function(){return[1,2,3,4,5,6,7,8]};function w(e,t){1&e&&(a["\u0275\u0275elementStart"](0,"div"),a["\u0275\u0275elementStart"](1,"div",39),a["\u0275\u0275template"](2,b,2,2,"div",40),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"]()),2&e&&(a["\u0275\u0275advance"](2),a["\u0275\u0275property"]("ngForOf",a["\u0275\u0275pureFunction0"](1,S)))}const E=function(){return{backdrop:!0,ignoreBackdropClick:!0}},C=function(){return{"background-image":"url(assets/placeholder.png)"}},I=[{path:"",component:(()=>{class e{constructor(e,t,n){this.api=e,this.util=t,this.router=n,this.dummy=[],this.users=[],this.msg="",this.messages=[],this.uid=localStorage.getItem("uid"),this.getChats()}ngOnInit(){}getChats(){const e={id:localStorage.getItem("uid")};this.dummy=Array(10),this.api.post("chats/getByGroup",e).then(e=>{if(console.log(e),e&&200===e.status){const t=[];e.data.forEach(e=>{t.push(e.from_id),t.push(e.room_id)});let n=[...new Set(t)];n=n.filter(e=>e!==localStorage.getItem("uid")),console.log("uniq->>",n);const i={id:n.join()};this.api.post("stores/getChatsNames",i).then(e=>{this.dummy=[],console.log(e),e&&200===e.status&&(this.users=e.data)},e=>{console.log(e),this.users=[],this.dummy=[],this.util.errorMessage(this.util.translate("Something went wrong"))})}else this.dummy=[]},e=>{console.log(e),this.util.errorMessage(this.util.translate("Something went wrong"))})}onAdmin(){this.id=0,this.loaded=!1,this.name="Support",this.getInbox(),this.interval=setInterval(()=>{console.log("calling in interval"),this.getInbox()},12e3),this.basicModal.show()}onChat(e){console.log(localStorage.getItem("uid")),this.id=e.id,this.loaded=!1,this.name=e.name,this.getInbox(),this.interval=setInterval(()=>{console.log("calling in interval"),this.getInbox()},12e3),this.basicModal.show()}getInbox(){this.api.post("chats/getById",{id:this.id+"_"+this.uid,oid:this.id}).then(e=>{console.log(e),this.loaded=!0,this.yourMessage=!0,e&&200===e.status&&(this.messages=e.data,this.scrollToBottom())},e=>{console.log(e),this.loaded=!0,this.yourMessage=!0,this.util.errorMessage(this.util.translate("Something went wrong"))})}scrollToBottom(){console.log(this.scrollMe.nativeElement.scrollTop),this.scrollMe.nativeElement.scrollTop=this.scrollMe.nativeElement.scrollHeight,console.log(this.scrollMe.nativeElement.scrollTop)}closeModal(){clearInterval(this.interval),this.basicModal.hide()}sendMessage(){if(console.log(this.msg),!this.msg||""===this.msg)return!1;const e=this.msg;this.msg="";const t={room_id:this.id,uid:this.id+"_"+this.uid,from_id:this.uid,message:e,message_type:"users",status:1,timestamp:l().format("YYYY-MM-DD HH:mm:ss")};this.yourMessage=!1,this.api.post("chats/save",t).then(e=>{console.log(e),e&&200===e.status?this.getInbox():this.yourMessage=!0},e=>{console.log(e),this.yourMessage=!0,this.util.errorMessage(this.util.translate("Something went wrong"))})}}return e.\u0275fac=function(t){return new(t||e)(a["\u0275\u0275directiveInject"](r.a),a["\u0275\u0275directiveInject"](d.a),a["\u0275\u0275directiveInject"](o.f))},e.\u0275cmp=a["\u0275\u0275defineComponent"]({type:e,selectors:[["app-chats"]],viewQuery:function(e,t){var n;1&e&&(a["\u0275\u0275viewQuery"](g,!0),a["\u0275\u0275viewQuery"](p,!0)),2&e&&(a["\u0275\u0275queryRefresh"](n=a["\u0275\u0275loadQuery"]())&&(t.basicModal=n.first),a["\u0275\u0275queryRefresh"](n=a["\u0275\u0275loadQuery"]())&&(t.scrollMe=n.first))},decls:36,vars:15,consts:[[1,"container"],["mdbModal","","tabindex","-1","role","dialog","aria-labelledby","myBasicModalLabel","aria-hidden","true",1,"modal","fade","bottom",2,"z-index","99999",3,"config"],["basicModal","mdbModal"],["role","document",1,"modal-dialog","modal-dialog-scrollable"],[1,"modal-content"],[1,"modal-header"],["type","button","aria-label","Close",1,"close","pull-right",3,"click"],["aria-hidden","true"],["id","myModalLabel",1,"modal-title","w-100"],[1,"modal-body"],["style","display: flex;flex-direction: column;justify-content: center;align-items: center;",4,"ngIf"],[1,"main_content_div"],["scrollMe",""],[4,"ngFor","ngForOf"],["style","display: flex;flex-direction: row-reverse;padding: 20px;",4,"ngIf"],[1,"modal-footer"],[2,"width","100%"],[1,"md-form"],["type","text","id","form8","rows","1","mdbInput","","mdbValidate","",1,"md-textarea","form-control",3,"ngModel","ngModelChange"],["for","form8"],["type","button","mdbBtn","","color","secondary","aria-label","Close",1,"waves-light",3,"click"],["type","button","mdbBtn","","color","primary",1,"relative","waves-light",3,"click"],[1,"row"],[1,"col-12","col-md-6",2,"cursor","pointer",3,"click"],[1,"boxed"],[1,"img_div",3,"ngStyle"],[1,"name"],["class","col-12 col-md-6","style","cursor: pointer;",3,"click",4,"ngFor","ngForOf"],[2,"display","flex","flex-direction","column","justify-content","center","align-items","center"],["role","status",1,"spinner-border"],[1,"sr-only"],["class","left_div",4,"ngIf"],["class","right_div",4,"ngIf"],[1,"left_div"],[1,"inner_div"],[1,"msg_div"],[1,"right_div"],[2,"display","flex","flex-direction","row-reverse","padding","20px"],[1,"mbl"],[1,"row",2,"overflow","hidden"],["class","col-12 col-md-6",4,"ngFor","ngForOf"],[1,"col-12","col-md-6"],[3,"theme"]],template:function(e,t){1&e&&(a["\u0275\u0275elementStart"](0,"div",0),a["\u0275\u0275elementStart"](1,"div",1,2),a["\u0275\u0275elementStart"](3,"div",3),a["\u0275\u0275elementStart"](4,"div",4),a["\u0275\u0275elementStart"](5,"div",5),a["\u0275\u0275elementStart"](6,"button",6),a["\u0275\u0275listener"]("click",(function(){return t.closeModal()})),a["\u0275\u0275elementStart"](7,"span",7),a["\u0275\u0275text"](8,"\xd7"),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementStart"](9,"h4",8),a["\u0275\u0275text"](10),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementStart"](11,"div",9),a["\u0275\u0275template"](12,u,4,1,"div",10),a["\u0275\u0275elementStart"](13,"div",11,12),a["\u0275\u0275template"](15,v,3,2,"span",13),a["\u0275\u0275elementEnd"](),a["\u0275\u0275template"](16,x,4,1,"div",14),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementStart"](17,"div",15),a["\u0275\u0275elementStart"](18,"div",16),a["\u0275\u0275elementStart"](19,"div",17),a["\u0275\u0275elementStart"](20,"textarea",18),a["\u0275\u0275listener"]("ngModelChange",(function(e){return t.msg=e})),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementStart"](21,"label",19),a["\u0275\u0275text"](22),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementStart"](23,"div"),a["\u0275\u0275elementStart"](24,"button",20),a["\u0275\u0275listener"]("click",(function(){return t.closeModal()})),a["\u0275\u0275text"](25),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementStart"](26,"button",21),a["\u0275\u0275listener"]("click",(function(){return t.sendMessage()})),a["\u0275\u0275text"](27),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementStart"](28,"div",22),a["\u0275\u0275elementStart"](29,"div",23),a["\u0275\u0275listener"]("click",(function(){return t.onAdmin()})),a["\u0275\u0275elementStart"](30,"div",24),a["\u0275\u0275element"](31,"div",25),a["\u0275\u0275elementStart"](32,"p",26),a["\u0275\u0275text"](33),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275template"](34,_,8,5,"div",27),a["\u0275\u0275elementEnd"](),a["\u0275\u0275template"](35,w,3,2,"div",13),a["\u0275\u0275elementEnd"]()),2&e&&(a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("config",a["\u0275\u0275pureFunction0"](13,E)),a["\u0275\u0275advance"](9),a["\u0275\u0275textInterpolate1"](" ",t.name," "),a["\u0275\u0275advance"](2),a["\u0275\u0275property"]("ngIf",!t.loaded),a["\u0275\u0275advance"](3),a["\u0275\u0275property"]("ngForOf",t.messages),a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("ngIf",!t.yourMessage&&t.loaded),a["\u0275\u0275advance"](4),a["\u0275\u0275property"]("ngModel",t.msg),a["\u0275\u0275advance"](2),a["\u0275\u0275textInterpolate1"](" ",t.util.translate("Type Here..")," "),a["\u0275\u0275advance"](3),a["\u0275\u0275textInterpolate"](t.util.translate("Close")),a["\u0275\u0275advance"](2),a["\u0275\u0275textInterpolate"](t.util.translate("Send Message")),a["\u0275\u0275advance"](4),a["\u0275\u0275property"]("ngStyle",a["\u0275\u0275pureFunction0"](14,C)),a["\u0275\u0275advance"](2),a["\u0275\u0275textInterpolate1"](" ",t.util.translate("Support")," "),a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("ngForOf",t.users),a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("ngForOf",t.dummy))},directives:[s.r,i.NgIf,i.NgForOf,c.a,s.p,s.q,c.i,c.l,s.n,i.NgStyle,m.a],styles:[".boxed[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.boxed[_ngcontent-%COMP%]   .img_div[_ngcontent-%COMP%]{height:50px;width:50px;min-width:50px;background-position:50%;background-repeat:no-repeat;background-size:contain;position:relative;margin:5px}.boxed[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:13px;font-weight:700;margin:0 0 0 20px}.main_content_div[_ngcontent-%COMP%]{width:100%;padding:15px}.main_content_div[_ngcontent-%COMP%]   .back_image[_ngcontent-%COMP%]{width:45px;height:45px;border-radius:100%;background-position:50%;background-repeat:no-repeat;background-size:cover;min-width:45px}.main_content_div[_ngcontent-%COMP%]   .left_div[_ngcontent-%COMP%]{width:100%;display:flex;margin-bottom:15px}.main_content_div[_ngcontent-%COMP%]   .left_div[_ngcontent-%COMP%]   .inner_div[_ngcontent-%COMP%]{width:70%;display:flex;flex-direction:row;justify-content:flex-start}.main_content_div[_ngcontent-%COMP%]   .left_div[_ngcontent-%COMP%]   .msg_div[_ngcontent-%COMP%]{background:#f0eff5;display:flex;align-items:center;padding:10px 15px;border-radius:25px;margin-left:5px}.main_content_div[_ngcontent-%COMP%]   .right_div[_ngcontent-%COMP%]{display:flex;width:100%;margin-bottom:15px;justify-content:flex-end}.main_content_div[_ngcontent-%COMP%]   .right_div[_ngcontent-%COMP%]   .inner_div[_ngcontent-%COMP%]{width:70%;display:flex;flex-direction:row;justify-content:flex-end}.main_content_div[_ngcontent-%COMP%]   .right_div[_ngcontent-%COMP%]   .msg_div[_ngcontent-%COMP%]{background-color:#45c261!important;display:flex;align-items:center;padding:10px 15px;border-radius:25px;margin-right:5px;color:#fff}"]}),e})()}];let O=(()=>{class e{}return e.\u0275mod=a["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=a["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[o.h.forChild(I)],o.h]}),e})();var k=n("PCNd");n.d(t,"ChatsModule",(function(){return P}));let P=(()=>{class e{}return e.\u0275mod=a["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=a["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[i.CommonModule,O,k.a,k.a,s.m.forRoot()]]}),e})()}}]);