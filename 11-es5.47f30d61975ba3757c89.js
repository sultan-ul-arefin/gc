function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"0dNq":function(e,t,n){"use strict";n.r(t);var o=n("ofXK"),r=n("tyNb"),i=n("wd/R"),a=n("fXoL"),l=n("H+bZ"),d=n("2Rin"),s=n("dbUT"),c=n("3Pt+"),m=n("xJkR"),u=["basicModal"],g=["scrollMe"];function p(e,t){if(1&e&&(a["\u0275\u0275elementStart"](0,"div",28),a["\u0275\u0275elementStart"](1,"div",29),a["\u0275\u0275elementStart"](2,"span",30),a["\u0275\u0275text"](3),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"]()),2&e){var n=a["\u0275\u0275nextContext"]();a["\u0275\u0275advance"](3),a["\u0275\u0275textInterpolate"](n.util.translate("Loading..."))}}function f(e,t){if(1&e&&(a["\u0275\u0275elementStart"](0,"div",33),a["\u0275\u0275elementStart"](1,"div",34),a["\u0275\u0275elementStart"](2,"div",35),a["\u0275\u0275elementStart"](3,"p"),a["\u0275\u0275text"](4),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"]()),2&e){var n=a["\u0275\u0275nextContext"]().$implicit;a["\u0275\u0275advance"](4),a["\u0275\u0275textInterpolate"](n.message)}}function v(e,t){if(1&e&&(a["\u0275\u0275elementStart"](0,"div",36),a["\u0275\u0275elementStart"](1,"div",34),a["\u0275\u0275elementStart"](2,"div",35),a["\u0275\u0275elementStart"](3,"p"),a["\u0275\u0275text"](4),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"]()),2&e){var n=a["\u0275\u0275nextContext"]().$implicit;a["\u0275\u0275advance"](4),a["\u0275\u0275textInterpolate"](n.message)}}function h(e,t){if(1&e&&(a["\u0275\u0275elementStart"](0,"span"),a["\u0275\u0275template"](1,f,5,1,"div",31),a["\u0275\u0275template"](2,v,5,1,"div",32),a["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit,o=a["\u0275\u0275nextContext"]();a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("ngIf",n.from_id!=o.uid),a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("ngIf",n.from_id==o.uid)}}function y(e,t){if(1&e&&(a["\u0275\u0275elementStart"](0,"div",37),a["\u0275\u0275elementStart"](1,"div",29),a["\u0275\u0275elementStart"](2,"span",30),a["\u0275\u0275text"](3),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"]()),2&e){var n=a["\u0275\u0275nextContext"]();a["\u0275\u0275advance"](3),a["\u0275\u0275textInterpolate"](n.util.translate("Loading..."))}}var x=function(e){return{"background-image":e}};function _(e,t){if(1&e){var n=a["\u0275\u0275getCurrentView"]();a["\u0275\u0275elementStart"](0,"div",23),a["\u0275\u0275listener"]("click",(function(){a["\u0275\u0275restoreView"](n);var e=t.$implicit;return a["\u0275\u0275nextContext"]().onChat(e)})),a["\u0275\u0275elementStart"](1,"div",24),a["\u0275\u0275element"](2,"div",25),a["\u0275\u0275elementStart"](3,"p",26),a["\u0275\u0275text"](4),a["\u0275\u0275element"](5,"br"),a["\u0275\u0275elementStart"](6,"span",38),a["\u0275\u0275text"](7),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"]()}if(2&e){var o=t.$implicit,r=a["\u0275\u0275nextContext"]();a["\u0275\u0275advance"](2),a["\u0275\u0275property"]("ngStyle",a["\u0275\u0275pureFunction1"](3,x,"url("+r.api.mediaURL+o.cover+")")),a["\u0275\u0275advance"](2),a["\u0275\u0275textInterpolate1"](" ",o.name," "),a["\u0275\u0275advance"](3),a["\u0275\u0275textInterpolate"](o.mobile)}}var b=function(){return{"border-radius":"5px",height:"120px",width:"100%"}};function M(e,t){1&e&&(a["\u0275\u0275elementStart"](0,"div",41),a["\u0275\u0275element"](1,"ngx-skeleton-loader",42),a["\u0275\u0275elementEnd"]()),2&e&&(a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("theme",a["\u0275\u0275pureFunction0"](1,b)))}var S=function(){return[1,2,3,4,5,6,7,8]};function C(e,t){1&e&&(a["\u0275\u0275elementStart"](0,"div"),a["\u0275\u0275elementStart"](1,"div",39),a["\u0275\u0275template"](2,M,2,2,"div",40),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"]()),2&e&&(a["\u0275\u0275advance"](2),a["\u0275\u0275property"]("ngForOf",a["\u0275\u0275pureFunction0"](1,S)))}var w,E,I=function(){return{backdrop:!0,ignoreBackdropClick:!0}},k=function(){return{"background-image":"url(assets/placeholder.png)"}},O=[{path:"",component:(w=function(){function e(t,n,o){_classCallCheck(this,e),this.api=t,this.util=n,this.router=o,this.dummy=[],this.users=[],this.msg="",this.messages=[],this.uid=localStorage.getItem("uid"),this.getChats()}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"getChats",value:function(){var e=this,t={id:localStorage.getItem("uid")};this.dummy=Array(10),this.api.post("chats/getByGroup",t).then((function(t){if(console.log(t),t&&200===t.status){var n=[];t.data.forEach((function(e){n.push(e.from_id),n.push(e.room_id)}));var o=_toConsumableArray(new Set(n));o=o.filter((function(e){return e!==localStorage.getItem("uid")})),console.log("uniq->>",o);var r={id:o.join()};e.api.post("stores/getChatsNames",r).then((function(t){e.dummy=[],console.log(t),t&&200===t.status&&(e.users=t.data)}),(function(t){console.log(t),e.users=[],e.dummy=[],e.util.errorMessage(e.util.translate("Something went wrong"))}))}else e.dummy=[]}),(function(t){console.log(t),e.util.errorMessage(e.util.translate("Something went wrong"))}))}},{key:"onAdmin",value:function(){var e=this;this.id=0,this.loaded=!1,this.name="Support",this.getInbox(),this.interval=setInterval((function(){console.log("calling in interval"),e.getInbox()}),12e3),this.basicModal.show()}},{key:"onChat",value:function(e){var t=this;console.log(localStorage.getItem("uid")),this.id=e.id,this.loaded=!1,this.name=e.name,this.getInbox(),this.interval=setInterval((function(){console.log("calling in interval"),t.getInbox()}),12e3),this.basicModal.show()}},{key:"getInbox",value:function(){var e=this;this.api.post("chats/getById",{id:this.id+"_"+this.uid,oid:this.id}).then((function(t){console.log(t),e.loaded=!0,e.yourMessage=!0,t&&200===t.status&&(e.messages=t.data,e.scrollToBottom())}),(function(t){console.log(t),e.loaded=!0,e.yourMessage=!0,e.util.errorMessage(e.util.translate("Something went wrong"))}))}},{key:"scrollToBottom",value:function(){console.log(this.scrollMe.nativeElement.scrollTop),this.scrollMe.nativeElement.scrollTop=this.scrollMe.nativeElement.scrollHeight,console.log(this.scrollMe.nativeElement.scrollTop)}},{key:"closeModal",value:function(){clearInterval(this.interval),this.basicModal.hide()}},{key:"sendMessage",value:function(){var e=this;if(console.log(this.msg),!this.msg||""===this.msg)return!1;var t=this.msg;this.msg="";var n={room_id:this.id,uid:this.id+"_"+this.uid,from_id:this.uid,message:t,message_type:"users",status:1,timestamp:i().format("YYYY-MM-DD HH:mm:ss")};this.yourMessage=!1,this.api.post("chats/save",n).then((function(t){console.log(t),t&&200===t.status?e.getInbox():e.yourMessage=!0}),(function(t){console.log(t),e.yourMessage=!0,e.util.errorMessage(e.util.translate("Something went wrong"))}))}}]),e}(),w.\u0275fac=function(e){return new(e||w)(a["\u0275\u0275directiveInject"](l.a),a["\u0275\u0275directiveInject"](d.a),a["\u0275\u0275directiveInject"](r.f))},w.\u0275cmp=a["\u0275\u0275defineComponent"]({type:w,selectors:[["app-chats"]],viewQuery:function(e,t){var n;1&e&&(a["\u0275\u0275viewQuery"](u,!0),a["\u0275\u0275viewQuery"](g,!0)),2&e&&(a["\u0275\u0275queryRefresh"](n=a["\u0275\u0275loadQuery"]())&&(t.basicModal=n.first),a["\u0275\u0275queryRefresh"](n=a["\u0275\u0275loadQuery"]())&&(t.scrollMe=n.first))},decls:36,vars:15,consts:[[1,"container"],["mdbModal","","tabindex","-1","role","dialog","aria-labelledby","myBasicModalLabel","aria-hidden","true",1,"modal","fade","bottom",2,"z-index","99999",3,"config"],["basicModal","mdbModal"],["role","document",1,"modal-dialog","modal-dialog-scrollable"],[1,"modal-content"],[1,"modal-header"],["type","button","aria-label","Close",1,"close","pull-right",3,"click"],["aria-hidden","true"],["id","myModalLabel",1,"modal-title","w-100"],[1,"modal-body"],["style","display: flex;flex-direction: column;justify-content: center;align-items: center;",4,"ngIf"],[1,"main_content_div"],["scrollMe",""],[4,"ngFor","ngForOf"],["style","display: flex;flex-direction: row-reverse;padding: 20px;",4,"ngIf"],[1,"modal-footer"],[2,"width","100%"],[1,"md-form"],["type","text","id","form8","rows","1","mdbInput","","mdbValidate","",1,"md-textarea","form-control",3,"ngModel","ngModelChange"],["for","form8"],["type","button","mdbBtn","","color","secondary","aria-label","Close",1,"waves-light",3,"click"],["type","button","mdbBtn","","color","primary",1,"relative","waves-light",3,"click"],[1,"row"],[1,"col-12","col-md-6",2,"cursor","pointer",3,"click"],[1,"boxed"],[1,"img_div",3,"ngStyle"],[1,"name"],["class","col-12 col-md-6","style","cursor: pointer;",3,"click",4,"ngFor","ngForOf"],[2,"display","flex","flex-direction","column","justify-content","center","align-items","center"],["role","status",1,"spinner-border","text-success"],[1,"sr-only"],["class","left_div",4,"ngIf"],["class","right_div",4,"ngIf"],[1,"left_div"],[1,"inner_div"],[1,"msg_div"],[1,"right_div"],[2,"display","flex","flex-direction","row-reverse","padding","20px"],[1,"mbl"],[1,"row",2,"overflow","hidden"],["class","col-12 col-md-6",4,"ngFor","ngForOf"],[1,"col-12","col-md-6"],[3,"theme"]],template:function(e,t){1&e&&(a["\u0275\u0275elementStart"](0,"div",0),a["\u0275\u0275elementStart"](1,"div",1,2),a["\u0275\u0275elementStart"](3,"div",3),a["\u0275\u0275elementStart"](4,"div",4),a["\u0275\u0275elementStart"](5,"div",5),a["\u0275\u0275elementStart"](6,"button",6),a["\u0275\u0275listener"]("click",(function(){return t.closeModal()})),a["\u0275\u0275elementStart"](7,"span",7),a["\u0275\u0275text"](8,"\xd7"),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementStart"](9,"h4",8),a["\u0275\u0275text"](10),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementStart"](11,"div",9),a["\u0275\u0275template"](12,p,4,1,"div",10),a["\u0275\u0275elementStart"](13,"div",11,12),a["\u0275\u0275template"](15,h,3,2,"span",13),a["\u0275\u0275elementEnd"](),a["\u0275\u0275template"](16,y,4,1,"div",14),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementStart"](17,"div",15),a["\u0275\u0275elementStart"](18,"div",16),a["\u0275\u0275elementStart"](19,"div",17),a["\u0275\u0275elementStart"](20,"textarea",18),a["\u0275\u0275listener"]("ngModelChange",(function(e){return t.msg=e})),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementStart"](21,"label",19),a["\u0275\u0275text"](22),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementStart"](23,"div"),a["\u0275\u0275elementStart"](24,"button",20),a["\u0275\u0275listener"]("click",(function(){return t.closeModal()})),a["\u0275\u0275text"](25),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementStart"](26,"button",21),a["\u0275\u0275listener"]("click",(function(){return t.sendMessage()})),a["\u0275\u0275text"](27),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementStart"](28,"div",22),a["\u0275\u0275elementStart"](29,"div",23),a["\u0275\u0275listener"]("click",(function(){return t.onAdmin()})),a["\u0275\u0275elementStart"](30,"div",24),a["\u0275\u0275element"](31,"div",25),a["\u0275\u0275elementStart"](32,"p",26),a["\u0275\u0275text"](33),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275template"](34,_,8,5,"div",27),a["\u0275\u0275elementEnd"](),a["\u0275\u0275template"](35,C,3,2,"div",13),a["\u0275\u0275elementEnd"]()),2&e&&(a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("config",a["\u0275\u0275pureFunction0"](13,I)),a["\u0275\u0275advance"](9),a["\u0275\u0275textInterpolate1"](" ",t.name," "),a["\u0275\u0275advance"](2),a["\u0275\u0275property"]("ngIf",!t.loaded),a["\u0275\u0275advance"](3),a["\u0275\u0275property"]("ngForOf",t.messages),a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("ngIf",!t.yourMessage&&t.loaded),a["\u0275\u0275advance"](4),a["\u0275\u0275property"]("ngModel",t.msg),a["\u0275\u0275advance"](2),a["\u0275\u0275textInterpolate1"](" ",t.util.translate("Type Here..")," "),a["\u0275\u0275advance"](3),a["\u0275\u0275textInterpolate"](t.util.translate("Close")),a["\u0275\u0275advance"](2),a["\u0275\u0275textInterpolate"](t.util.translate("Send Message")),a["\u0275\u0275advance"](4),a["\u0275\u0275property"]("ngStyle",a["\u0275\u0275pureFunction0"](14,k)),a["\u0275\u0275advance"](2),a["\u0275\u0275textInterpolate1"](" ",t.util.translate("Support")," "),a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("ngForOf",t.users),a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("ngForOf",t.dummy))},directives:[s.r,o.NgIf,o.NgForOf,c.a,s.p,s.q,c.i,c.l,s.n,o.NgStyle,m.a],styles:[".boxed[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.boxed[_ngcontent-%COMP%]   .img_div[_ngcontent-%COMP%]{height:50px;width:50px;min-width:50px;background-position:50%;background-repeat:no-repeat;background-size:contain;position:relative;margin:5px}.boxed[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:13px;font-weight:700;margin:0 0 0 20px}.main_content_div[_ngcontent-%COMP%]{width:100%;padding:15px}.main_content_div[_ngcontent-%COMP%]   .back_image[_ngcontent-%COMP%]{width:45px;height:45px;border-radius:100%;background-position:50%;background-repeat:no-repeat;background-size:cover;min-width:45px}.main_content_div[_ngcontent-%COMP%]   .left_div[_ngcontent-%COMP%]{width:100%;display:flex;margin-bottom:15px}.main_content_div[_ngcontent-%COMP%]   .left_div[_ngcontent-%COMP%]   .inner_div[_ngcontent-%COMP%]{width:70%;display:flex;flex-direction:row;justify-content:flex-start}.main_content_div[_ngcontent-%COMP%]   .left_div[_ngcontent-%COMP%]   .msg_div[_ngcontent-%COMP%]{background:#f0eff5;display:flex;align-items:center;padding:10px 15px;border-radius:25px;margin-left:5px}.main_content_div[_ngcontent-%COMP%]   .right_div[_ngcontent-%COMP%]{display:flex;width:100%;margin-bottom:15px;justify-content:flex-end}.main_content_div[_ngcontent-%COMP%]   .right_div[_ngcontent-%COMP%]   .inner_div[_ngcontent-%COMP%]{width:70%;display:flex;flex-direction:row;justify-content:flex-end}.main_content_div[_ngcontent-%COMP%]   .right_div[_ngcontent-%COMP%]   .msg_div[_ngcontent-%COMP%]{background-color:#45c261!important;display:flex;align-items:center;padding:10px 15px;border-radius:25px;margin-right:5px;color:#fff}"]}),w)}],P=((E=function e(){_classCallCheck(this,e)}).\u0275mod=a["\u0275\u0275defineNgModule"]({type:E}),E.\u0275inj=a["\u0275\u0275defineInjector"]({factory:function(e){return new(e||E)},imports:[[r.h.forChild(O)],r.h]}),E),A=n("PCNd");n.d(t,"ChatsModule",(function(){return T}));var j,T=((j=function e(){_classCallCheck(this,e)}).\u0275mod=a["\u0275\u0275defineNgModule"]({type:j}),j.\u0275inj=a["\u0275\u0275defineInjector"]({factory:function(e){return new(e||j)},imports:[[o.CommonModule,P,A.a,A.a,s.m.forRoot()]]}),j)}}]);