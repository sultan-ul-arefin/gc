(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{HK0l:function(e,t,r){"use strict";r.r(t);var o=r("ofXK"),a=r("tyNb"),l=r("mrSG"),s=r("wd/R"),i=r("fXoL"),c=r("H+bZ"),m=r("2Rin"),n=r("c14U");const d=[{path:"",component:(()=>{class e{constructor(e,t,r,o,a){this.route=e,this.api=t,this.util=r,this.cart=o,this.router=a,this.route.queryParams.subscribe(e=>{console.log(e),e&&"successful"===e.status?(e=>{try{return JSON.parse(e),!0}catch(t){return!1}})(localStorage.getItem("cartItems"))?(this.cart.cart=JSON.parse(localStorage.getItem("cartItems")),this.cart.deliveryAt=localStorage.getItem("deliveryAt"),this.cart.datetime=localStorage.getItem("datetime"),this.cart.totalPrice=localStorage.getItem("totalPrice"),this.cart.orderTax=localStorage.getItem("orderTax"),this.cart.grandTotal=localStorage.getItem("grandTotal"),this.cart.deliveryPrice=localStorage.getItem("deliveryPrice"),this.cart.coupon=(e=>{try{return JSON.parse(e),!0}catch(t){return!1}})(localStorage.getItem("appliedCoupon"))?JSON.parse(localStorage.getItem("appliedCoupon")):null,this.cart.userOrderTaxByStores=(e=>{try{return JSON.parse(e),!0}catch(t){return!1}})(localStorage.getItem("userOrderTaxByStores"))?JSON.parse(localStorage.getItem("userOrderTaxByStores")):[],this.cart.deliveryAddress=(e=>{try{return JSON.parse(e),!0}catch(t){return!1}})(localStorage.getItem("selectedAddress"))?JSON.parse(localStorage.getItem("selectedAddress")):null,this.cart.discount=localStorage.getItem("discount"),console.log("cart instance calcuatelllll,,,,,",this.cart),this.createOrder("flutterwave",e.transaction_id)):(console.log("somerthing went wrong"),localStorage.removeItem("cartItems"),localStorage.removeItem("deliveryAt"),localStorage.removeItem("datetime"),localStorage.removeItem("totalPrice"),localStorage.removeItem("orderTax"),localStorage.removeItem("grandTotal"),localStorage.removeItem("deliveryPrice"),localStorage.removeItem("appliedCoupon"),localStorage.removeItem("userOrderTaxByStores"),localStorage.removeItem("discount"),localStorage.removeItem("selectedAddress"),this.util.errorMessage(this.util.translate("Something went wrong"))):(localStorage.removeItem("cartItems"),localStorage.removeItem("deliveryAt"),localStorage.removeItem("datetime"),localStorage.removeItem("totalPrice"),localStorage.removeItem("orderTax"),localStorage.removeItem("grandTotal"),localStorage.removeItem("deliveryPrice"),localStorage.removeItem("appliedCoupon"),localStorage.removeItem("userOrderTaxByStores"),localStorage.removeItem("discount"),localStorage.removeItem("selectedAddress"),this.util.errorMessage(this.util.translate("Something went wrong")),this.router.navigate([""]))})}ngOnInit(){}createOrder(e,t){return Object(l.a)(this,void 0,void 0,(function*(){const r=[...new Set(this.cart.cart.map(e=>e.store_id))],o=[];r.forEach(e=>{o.push({id:e,status:"created"})});const a=[{status:1,value:"Order Created",time:s().format("lll")}];this.cart.deliveryAt=this.cart.deliveryAt?this.cart.deliveryAt:"";const l={uid:localStorage.getItem("uid"),store_id:r.join(),date_time:"today"===this.cart.datetime?s().format("YYYY-MM-DD HH:mm:ss"):s().add(1,"days").format("YYYY-MM-DD HH:mm:ss"),paid_method:e,order_to:this.cart.deliveryAt,orders:JSON.stringify(this.cart.cart),notes:JSON.stringify(a),address:"home"===this.cart.deliveryAt?JSON.stringify(this.cart.deliveryAddress):"",driver_id:"",total:this.cart.totalPrice,tax:this.cart.orderTax,grand_total:this.cart.grandTotal,delivery_charge:this.cart.deliveryPrice,coupon_code:this.cart.coupon?JSON.stringify(this.cart.coupon):"",discount:this.cart.discount,pay_key:t,status:JSON.stringify(o),assignee:"",extra:JSON.stringify(this.cart.userOrderTaxByStores)};console.log("param-----\x3e",l),this.util.start(),this.api.post("orders/save",l).then(e=>{console.log(e),this.util.stop(),localStorage.removeItem("cartItems"),localStorage.removeItem("deliveryAt"),localStorage.removeItem("datetime"),localStorage.removeItem("totalPrice"),localStorage.removeItem("orderTax"),localStorage.removeItem("grandTotal"),localStorage.removeItem("deliveryPrice"),localStorage.removeItem("appliedCoupon"),localStorage.removeItem("userOrderTaxByStores"),localStorage.removeItem("discount"),localStorage.removeItem("selectedAddress"),this.util.errorMessage(this.util.translate("Something went wrong")),this.api.createOrderNotification(this.cart.stores),this.cart.clearCart(),this.util.publishNewOrder();const t=(this.util.userInfo.first_name+"-"+this.util.userInfo.last_name).toLowerCase();this.router.navigate(["user",t,"order"])},e=>{console.log(e),this.util.stop(),localStorage.removeItem("cartItems"),localStorage.removeItem("deliveryAt"),localStorage.removeItem("datetime"),localStorage.removeItem("totalPrice"),localStorage.removeItem("orderTax"),localStorage.removeItem("grandTotal"),localStorage.removeItem("deliveryPrice"),localStorage.removeItem("appliedCoupon"),localStorage.removeItem("userOrderTaxByStores"),localStorage.removeItem("discount"),localStorage.removeItem("selectedAddress"),this.util.errorMessage(this.util.translate("Something went wrong")),this.util.errorMessage(this.util.translate("Something went wrong"))}).catch(e=>{console.log(e),this.util.stop(),localStorage.removeItem("cartItems"),localStorage.removeItem("deliveryAt"),localStorage.removeItem("datetime"),localStorage.removeItem("totalPrice"),localStorage.removeItem("orderTax"),localStorage.removeItem("grandTotal"),localStorage.removeItem("deliveryPrice"),localStorage.removeItem("appliedCoupon"),localStorage.removeItem("userOrderTaxByStores"),localStorage.removeItem("discount"),localStorage.removeItem("selectedAddress"),this.util.errorMessage(this.util.translate("Something went wrong")),this.util.errorMessage(this.util.translate("Something went wrong"))})}))}}return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](a.a),i["\u0275\u0275directiveInject"](c.a),i["\u0275\u0275directiveInject"](m.a),i["\u0275\u0275directiveInject"](n.a),i["\u0275\u0275directiveInject"](a.f))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["app-flutterwavecallback"]],decls:2,vars:1,consts:[[2,"text-align","center"]],template:function(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"h2",0),i["\u0275\u0275text"](1),i["\u0275\u0275elementEnd"]()),2&e&&(i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate1"](" ",t.util.translate("Please wait, we are processing your order")," "))},styles:[""]}),e})()}];let g=(()=>{class e{}return e.\u0275mod=i["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=i["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[a.h.forChild(d)],a.h]}),e})();r.d(t,"FlutterwavecallbackModule",(function(){return u}));let u=(()=>{class e{}return e.\u0275mod=i["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=i["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[o.CommonModule,g]]}),e})()}}]);